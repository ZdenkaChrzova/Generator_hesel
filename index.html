<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Gener√°tor hesel - P≈ôihl√°≈°en√≠</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- P≈ôihla≈°ovac√≠ okno -->
    <div id="loginBox" class="container">
        <h1>üîí P≈ôihl√°≈°en√≠</h1>
        <input type="text" id="loginUser" placeholder="U≈æivatelsk√© jm√©no" autocomplete="username" />
        <input type="password" id="loginPassword" placeholder="Heslo" autocomplete="current-password" />
        <button id="loginBtn" class="btn-main">P≈ôihl√°sit se</button>
        <button id="registerBtn" class="btn-secondary">Zaregistrovat / Nastavit heslo</button>
        <div id="loginError" style="color: red; margin-top: 10px;"></div>
    </div>
    <!-- Okno pro nastaven√≠/zmƒõnu hesla -->
    <div id="setPasswordBox" class="container" style="display:none;">
        <h1>üîë Nastavit/zmƒõnit heslo</h1>
        <input type="text" id="setUser" placeholder="U≈æivatelsk√© jm√©no" autocomplete="username" />
        <input type="password" id="setPassword" placeholder="Nov√© heslo" autocomplete="new-password" />
        <button id="setPasswordBtn" class="btn-main">Nastavit heslo</button>
        <button id="backToLogin" class="btn-secondary">Zpƒõt na p≈ôihl√°≈°en√≠</button>
        <div id="setPasswordError" style="color: red; margin-top: 10px;"></div>
    </div>
    <!-- Hlavn√≠ aplikace (skryt√° dokud nen√≠ p≈ôihl√°≈°en√≠) -->
    <div id="mainApp" style="display: none;">
        <div class="container">
            <h1>üîí Gener√°tor hesel</h1>
            <div id="welcome"></div>
            <button id="changePwdBtn" class="btn-secondary" style="margin-bottom:20px;">Zmƒõnit heslo</button>
            <form id="passwordForm" class="form-box">
                <div class="form-row">
                    <input type="text" id="appName" required placeholder="N√°zev aplikace/webu">
                </div>
                <div class="form-row">
                    <input type="text" id="username" required placeholder="Username">
                </div>
                <div class="form-row">
                    <input type="number" id="length" min="6" value="10" required placeholder="Poƒçet znak≈Ø">
                </div>
                <div class="options-row">
                    <span>Mo≈ænosti hesla:</span>
                    <label class="checkbox-label"><input type="checkbox" id="uppercase" checked> Velk√° p√≠smena (A-Z)</label>
                    <label class="checkbox-label"><input type="checkbox" id="digits" checked> ƒå√≠slice (0-9)</label>
                    <label class="checkbox-label"><input type="checkbox" id="special" checked> Speci√°ln√≠ znaky (!@#$...)</label>
                </div>
                <div class="form-row">
                    <button type="submit" class="btn-main">‚ú® Vygenerovat heslo</button>
                </div>
            </form>
            <div id="result" class="result" style="display:none;">
                <div class="generated-label">Vygenerovan√© heslo:</div>
                <div class="generated-password" id="generatedPassword"></div>
            </div>
            
            <h2>üïí Historie hesel</h2>
            <button id="exportCSV" class="btn-secondary">‚¨áÔ∏è Exportovat CSV</button>
            <table id="historyTable">
                <thead>
                    <tr>
                        <th>Datum</th>
                        <th>Aplikace/Web</th>
                        <th>Username</th>
                        <th>Heslo</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Historie se zde zobraz√≠ -->
                </tbody>
            </table>
        </div>
    </div>
    <script src="script.js"></script>
    <script>
    // U≈æivatel√© a hesla jsou ulo≈æeny v LocalStorage jako objekt {username: password}
    function getUsers() {
        return JSON.parse(localStorage.getItem("users_db") || "{}");
    }
    function setUsers(usersObj) {
        localStorage.setItem("users_db", JSON.stringify(usersObj));
    }
    // Aktu√°lnƒõ p≈ôihl√°≈°en√Ω u≈æivatel
    let currentUser = null;

    // P≈ôihl√°≈°en√≠
    document.getElementById("loginBtn").onclick = function() {
        const user = document.getElementById("loginUser").value.trim();
        const pwd = document.getElementById("loginPassword").value;
        const users = getUsers();
        if (user in users && users[user] === pwd) {
            currentUser = user;
            showMainApp();
        } else {
            document.getElementById("loginError").textContent = "≈†patn√© jm√©no nebo heslo!";
        }
    };
    // Registrace / zmƒõna hesla
    document.getElementById("registerBtn").onclick = function() {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("setPasswordBox").style.display = "block";
        document.getElementById("setUser").value = document.getElementById("loginUser").value;
    };
    document.getElementById("backToLogin").onclick = function() {
        document.getElementById("setPasswordBox").style.display = "none";
        document.getElementById("loginBox").style.display = "block";
    };
    document.getElementById("setPasswordBtn").onclick = function() {
        const user = document.getElementById("setUser").value.trim();
        const pwd = document.getElementById("setPassword").value;
        if (!user) {
            document.getElementById("setPasswordError").textContent = "Zadejte jm√©no!";
            return;
        }
        if (!pwd) {
            document.getElementById("setPasswordError").textContent = "Zadejte heslo!";
            return;
        }
        const users = getUsers();
        users[user] = pwd;
        setUsers(users);
        document.getElementById("setPasswordError").textContent = "";
        document.getElementById("setPasswordBox").style.display = "none";
        document.getElementById("loginBox").style.display = "block";
        document.getElementById("loginUser").value = user;
        document.getElementById("loginPassword").value = "";
        document.getElementById("loginError").textContent = "Heslo nastaveno, m≈Ø≈æete se p≈ôihl√°sit.";
    };
    // Enter tak√© spust√≠ p≈ôihl√°≈°en√≠/registraci
    document.getElementById("loginUser").addEventListener("keydown", function(e) {
        if (e.key === "Enter") document.getElementById("loginBtn").click();
    });
    document.getElementById("loginPassword").addEventListener("keydown", function(e) {
        if (e.key === "Enter") document.getElementById("loginBtn").click();
    });
    document.getElementById("setUser").addEventListener("keydown", function(e) {
        if (e.key === "Enter") document.getElementById("setPasswordBtn").click();
    });
    document.getElementById("setPassword").addEventListener("keydown", function(e) {
        if (e.key === "Enter") document.getElementById("setPasswordBtn").click();
    });

    // Zmƒõna hesla z hlavn√≠ aplikace
    document.getElementById("changePwdBtn").onclick = function() {
        document.getElementById("mainApp").style.display = "none";
        document.getElementById("setPasswordBox").style.display = "block";
        document.getElementById("setUser").value = currentUser;
    };

    // Zobrazen√≠ hlavn√≠ aplikace po p≈ôihl√°≈°en√≠
    function showMainApp() {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("setPasswordBox").style.display = "none";
        document.getElementById("mainApp").style.display = "block";
        document.getElementById("welcome").textContent = "P≈ôihl√°≈°en jako: " + currentUser;
    }
    </script>
</body>
</html>
